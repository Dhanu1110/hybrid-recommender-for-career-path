# Project Update: Knowledge-Aware Hybrid Recommender for Sustainable Career Path and Proactive Upskilling

This document provides a detailed overview of the hybrid recommender system, covering its architecture, data pipeline, modeling stages, and user interface.

## 1. Project Overview

The project implements a sophisticated three-stage cascaded hybrid recommender system designed to provide sustainable career path recommendations and proactive upskilling suggestions. The system combines a transformer-based model for path generation, a knowledge-graph-based reasoner for skill-gap analysis, and a content-based system for recommending learning resources.

The core architecture is as follows:
1.  **Stage 1: Path Generation**: A BERT4Rec transformer model generates potential career paths.
2.  **Stage 2: Skill Gap Reasoning**: The ESCO (European Skills, Competences, Qualifications and Occupations) knowledge graph is used to analyze the feasibility of the generated paths and identify skill gaps.
3.  **Stage 3: Resource Recommendation**: A content-based recommendation system suggests learning resources to bridge the identified skill gaps.

## 2. Data Pipeline and Ingestion

The data pipeline is managed by the scripts in the `src/ingest/` directory and is responsible for preparing the data for the recommendation models.

### Data Sources
The system relies on four main data sources, which should be placed in the `data/raw/` directory:
-   `karrierewege.csv`: Contains career path data with user IDs and job sequences.
-   `esco_occupations.csv`: ESCO data for occupations, including titles and descriptions.
-   `esco_skills.csv`: ESCO data for skills, including titles, descriptions, and skill types.
-   `esco_relations.csv`: Defines the relationships between ESCO occupations and skills.

### Key Scripts and Functionality
-   **`download_and_prepare.py`**: This script is the main entry point for the data pipeline. It handles the downloading of raw data and prepares it for processing. It can also generate synthetic data for testing purposes.
-   **`esco_loader.py`**: This script is responsible for loading the ESCO data into a structured format that can be used by the skill gap reasoner.
-   **`generate_synthetic_data.py`**: This script creates synthetic career path data, which is useful for testing the system without real user data.
-   **`text_to_esco_mapper.py`**: This script maps free-text job titles to the standardized ESCO ontology, ensuring consistency in the data.

## 3. Stage 1: Path Generation (BERT4Rec)

The first stage of the recommender system uses a BERT4Rec model to generate candidate career paths. The implementation is located in the `src/models/` directory.

### Model Architecture
-   **`bert4rec.py`**: This file contains the implementation of the BERT4Rec model, which is a bidirectional transformer-based model. It uses the masked language modeling objective to predict missing jobs in a career sequence, making it well-suited for path prediction.

### Training
-   **`train_path_model.py`**: This script is used to train the BERT4Rec model. It can be configured to train on either synthetic or real data and allows for the adjustment of hyperparameters such as the number of epochs and batch size.

### Recommender Logic
-   **`career_path_recommender.py`**: This script contains the main logic for the career path recommender, integrating the trained BERT4Rec model to generate recommendations.

## 4. Stage 2: Skill Gap Reasoning

The second stage of the system uses the ESCO knowledge graph to perform skill gap analysis on the career paths generated by the BERT4Rec model. The code for this stage is in the `src/reasoner/` directory.

### Key Functionality
-   **`skill_gap.py`**: This script implements the skill gap analysis. It takes a candidate career path and uses the ESCO ontology to:
    -   Calculate the skill distance between jobs in the path.
    -   Determine the feasibility of the career transition based on the identified skill gaps.
    -   Provide a feasibility score that is combined with the model's confidence score to produce a final recommendation.

## 5. Stage 3: Resource Recommendation

The third stage of the system recommends learning resources to help users bridge the skill gaps identified in Stage 2.

### Methodology
-   **TF-IDF and Sentence Embeddings**: The system uses a combination of TF-IDF and sentence embedding similarity to match learning resources to the required skills.
-   **FAISS**: A FAISS-based nearest neighbor search is used for efficient retrieval of relevant resources.
-   **Prerequisite Ordering**: The system also considers the prerequisite relationships between skills to suggest a logical learning path.

## 6. User Interface (Streamlit)

The project includes an interactive web application built with Streamlit, allowing users to interact with the recommender system.

### UI Implementation
-   **`app/streamlit_app.py`**: This file contains the code for the Streamlit application. It provides a user-friendly interface for:
    -   Inputting a user's current career status.
    -   Displaying the recommended career paths.
    -   Visualizing the skill gap analysis.
    -   Presenting the recommended learning resources.

## 7. Evaluation Metrics

The system's performance is evaluated using a comprehensive set of metrics to assess the quality of the recommendations.

-   **Accuracy**: `Precision@k`, `Recall@k`, `NDCG@k`
-   **Diversity**: Intra-list similarity
-   **Novelty**: Measures how surprising the recommendations are.
-   **Serendipity**: A combination of unexpectedness and relevance.

The evaluation can be run using the `src/eval/evaluate.py` script.

## 8. Setup and Usage

### Installation
1.  Clone the repository.
2.  Create and activate a virtual environment.
3.  Install the required dependencies from `requirements.txt`.

### Running the Application
-   **Streamlit App**: `streamlit run app/streamlit_app.py`
-   **FastAPI Backend**: `uvicorn src.api.server:app --host 0.0.0.0 --port 8000`
-   **Docker**: `docker-compose up -d`
